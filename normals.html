<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>
</head>
<body>
    <canvas id="drawing" width="64" height="64"></canvas>

    <img src="#" id="display" width="64" height="64">

    <img src="./canvas.png" id="input-image" width="64" height="64">

    <script src="loadWasm.js" type="module"></script>
    <script src="./jquery-ui-1.12.1.custom/external/jquery/jquery.js"></script>
    <script src="./jquery-ui-1.12.1.custom/jquery-ui.js"></script>
    <script type="module">
      import { importWasm } from './loadWasm.js'
      import { normal_map } from './pkg/texture_looper.js'

      function init() {
        let c = document.getElementById('drawing');
        var ctx = c.getContext("2d");
        ctx.drawImage(document.getElementById('input-image'), 0, 0, 64, 64);

        let b64 = document.getElementById('drawing').toDataURL('image/png');
        let img = document.getElementById('display');
        console.log('starting...');
        img.src = normal_map(b64);
        console.log('done...');
      }

      window.onload = () => {
        importWasm().then(init);
      }
    </script>
</body>
</html>
